<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>
<script src="//fgnass.github.io/spin.js/spin.min.js"></script>

<script>
var validateForm = function() {
    var re = /\S+@\S+\.\S+/;
    if (! re.test(document.subscribeForm.email.value))
    {
        document.getElementById('error').innerHTML = 'Please enter a valid email address.';
        return false;
    }
    return true;
};
</script>

<div id="content" class="row">
    <div class="row">
      <h2 style="text-align:center;">{{ subhead }}</h2>
    </div>
    <div class="row">
      <form name="subscribeForm" action='https://pledge.mayday.us/r/subscribe' onsubmit='return validateForm();' method='post'>

        <div class="row">
          <div class="input-group input-group-lg">
                      <div class="social" id="sidesocial">
                      <P>Let's win our democracy back. Can you share with your friends and ask them to join the #MaydayMovement?</P>
              <div class="twitter"><a href="https://twitter.com/home?status=Money%20has%20corrupted%20our%20democracy.%20Can%20we%20fix%20it?%20Act%20now,%20join%20%23MAYDAYUS%20--%20let's%20try%20something%20new:%20MAYDAY.US" title="Share on Twitter"><span>Share on Twitter</span></a></div>
              <div class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=https://mayday.us?1" title="Share on Facebook"><span>Share on Facebook</span></a></div>
              <div class="email">
                  <a href='mailto:?to=&subject=A%20Mayday%20call%20for%20our%20democracy&body=Giving%20money%20to%20a%20super%20PAC%20is%20one%20of%20the%20last%20things%20I%20thought%20I%E2%80%99d%20ever%20do%E2%80%A6%20but%20I%20just%20did.%0A%0AI%20recently%20joined%20Lawrence%20Lessig%E2%80%99s%20citizen-funded%20Mayday%20PAC%2C%20an%20ambitious%20campaign%20to%20win%20a%20Congress%20committed%20to%20ending%20corruption%20in%202016%2C%20and%20we%20did%20something%20amazing%3A%20we%20reached%20over%20%241%20million%20in%20pledges%20in%20just%20two%20weeks%20in%20May.%20That%E2%80%99s%20a%20ton%20of%20money%2C%20but%20it%E2%80%99s%20not%20enough.%0A%0AStage%20two%20is%20now%20on%2C%20and%20we%E2%80%99ve%20upped%20the%20ante%3A%20we%20aim%20to%20raise%20%245%20million%20by%20July%204%20and%20declare%20independence%20from%20a%20broken%2C%20corrupt%20system.%20I%E2%80%99m%20writing%20to%20my%20friends%20and%20family%20to%20ask%20if%20you%20can%20help%20us%20get%20there.%20If%20all%20of%20us%20who%20have%20supported%20the%20Mayday%20PAC%20so%20far%20each%20recruit%20just%20five%20friends%2C%20we%E2%80%99d%20easily%20hit%20that%20goal.%20So%20my%20question%20is%3A%20will%20you%20be%20one%20of%20those%20five%3F%0A%0AI%20don%E2%80%99t%20have%20to%20tell%20you%20why%20this%20is%20important.%20We%20all%20know%20our%20government%20is%20dismally%20dysfunctional%20because%20politicians%20spend%20all%20their%20time%20raising%20money%20instead%20of%20doing%20the%20jobs%20they%20were%20elected%20to%20do.%20So%20our%20plan%20is%20to%20fight%20fire%20with%20fire%3A%20raise%20the%20money%20needed%20to%20elect%20representatives%20that%20are%20committed%20to%20the%20reform%20we%20so%20desperately%20need.%0A%0AYou%20can%20read%20all%20about%20the%20Mayday%20PAC%20via%20our%20web%20site%2C%20https%3A%2F%2Fmayday.us%2C%20but%20once%20you%20do%2C%20please%20consider%20joining%20me%20in%20making%20a%20pledge.%20This%20is%20a%20totally%20crazy%20plan%2C%20but%20I%E2%80%99m%20beginning%20to%20think%20it%E2%80%99s%20so%20crazy%20that%20it%20just%20might%20work.%20It%E2%80%99d%20mean%20the%20world%20to%20have%20your%20support.%0A%0AYours%2C%20'
                  target="_blank" title="Share with Email"><span>Share with Email</span></a>
              </div>
            </div>
            <P>Would you like to tell us a bit more about yourself?</P>
            <label>Email (required)</label>
            <input id='email_input' type="email" required name="email" class="form-control">
          </div>
        </div>

        <div class="row">
           <div class="input-group input-group-lg">
         <label>First Name</label>
            <input type="text" name="first_name" class="form-control">
          </div>
        </div>

        <div class="row">
           <div class="input-group input-group-lg">
         <label>Last Name</label>
            <input type="text" name="last_name" class="form-control">
          </div>
        </div>

        <div class="row">
           <div class="input-group input-group-lg">
         <label>Zip Code</label>
            <input type="text" name="zipcode" class="form-control">
          </div>
        </div>

        <div class="row">
           <div class="input-group input-group-lg">
         <label class="checkbox"><input type="checkbox" name="volunteer" class="form-control" onclick="document.getElementById('skills_section').style.display = 'block';"> Do you want to volunteer?</label>
          </div>
        </div>

        <div id="skills_section" class="row" style="display:none">
           <div class="input-group input-group-lg">
         <label><input type="text" name="skills" class="form-control" maxlength="254"> Do you have any specific skills that can help us with organizing? (Both technical and non-technical!)</label>
          </div>
        </div>

        <div class="row">
           <div class="input-group input-group-lg">
         <label class="checkbox" id="rootstrikersCheckbox"><input type="checkbox" name="rootstrikers" class="form-control" checked> Receive updates from Rootstrikers, a MAYDAY.us ally working to remove the root problem of corruption from American government.</label>
          </div>
        </div>

        <input type="hidden" name="source" id="sourceElement" value="{% if page.mailchimpSource %}{{ page.mailchimpSource }}{% else %}subscribe{% endif %}"/>

        <div ng-show="! ctrl.spinning" class="row">
           <span class="input-group-btn">
              <button id="submitButton" type="submit" class="btn btn-primary">Subscribe</button>
            </span>
        </div>

        <div ng-show="ctrl.spinning" class="row">
          <div id="spinButton" class="spacing" style="position:relative;"></div>
        </div>

        <div ng-show="ctrl.error" class="edd_errors row">
          <p id="error"></p>
        </div>

      </form>

    </div>
</div>

<script>
  function getParameterByName(name) {
      name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
      var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
          results = regex.exec(location.search);
      return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
  }

$( document ).ready( function() {
  var email = getParameterByName('email'); 
  var source_val = getParameterByName('source'); 
  var email_input = document.getElementById("email_input");
  var source_input = document.getElementById("sourceElement");
  email_input.value=email;
  source_val = source_val || null;
  if (source_val) {
    source_input.value = source_val;
  }
});

</script>
